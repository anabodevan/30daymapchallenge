{
  "hash": "7d6fcd45d48c55f2e57347d9c8946860",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Air\"\nauthor: \"Ana Luisa Bodevan\"\ndescription: \"ATL Flight Routes\"\nimage: \"10_air.png\"\nexecute:\n  warning: false\n  message: false\n  eval: true\nformat:\n  html:\n    code-tools: true\n    code-fold: true\n---\n\n# Day 10: Air\n\n| Classical Elements 2/4: Focus on the atmosphere. Map weather, wind patterns, air traffic, pollution, or airborne transmission (e.g., pollen, sound).\n\nHartsfield-Jackson Atlanta International Airport (ATL) is the busiest airport in the world, with 108 million total passengers in 2024. In this map, we will visualize the domestic flights routes out of it. \n\n## SETUP\n\n### Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pacman)\n\npacman :: p_load(tidyverse, dplyr, anyflights, sf, igraph, ggraph, geosphere, maps)\n```\n:::\n\n\n### Load data \n\n\n::: {.cell}\n\n```{.r .cell-code}\nflights_2024 <- get_flights(station = \"ATL\", year = 2024, month = 1)\n```\n:::\n\n\n## DATA WRANGLING \n\n### Filtering \n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_airports <- get_airports()\n\n# Get airport coordinates\nairport_coords <- us_airports %>%\n  select(faa, name, lat, lon) %>%\n  filter(!is.na(lat), !is.na(lon))  # Remove airports without coordinates\n\n\natl_routes <- flights_2024 %>%\n  filter(origin == \"ATL\") %>%\n  group_by(origin, dest) %>%\n  summarise(n_flights = n(), .groups = 'drop') %>%\n  filter(origin %in% airport_coords$faa, dest %in% airport_coords$faa)\n```\n:::\n\n\n### Create network\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflight_network <- graph_from_data_frame(atl_routes, directed = TRUE)\n\n# Match coordinates to vertices\nV(flight_network)$lat <- airport_coords$lat[match(V(flight_network)$name, airport_coords$faa)]\nV(flight_network)$lon <- airport_coords$lon[match(V(flight_network)$name, airport_coords$faa)]\nV(flight_network)$airport_name <- airport_coords$name[match(V(flight_network)$name, airport_coords$faa)]\n\n# Identify ATL for special styling\nV(flight_network)$is_atl <- V(flight_network)$name == \"ATL\"\n\n# Get US map data\nus_map <- map_data(\"state\")\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggraph(flight_network, layout = 'manual', x = lon, y = lat) +\n\n  # US state boundaries\n  geom_polygon(data = us_map, \n               aes(x = long, y = lat, group = group),\n               fill = \"black\", \n               color = \"white\", \n               size = 0.4,\n               inherit.aes = FALSE) +\n\n  # Flight routes (edges)\n  geom_edge_arc(aes(width = n_flights),\n                color = \"gold\",\n                alpha = 0.2,\n                linewidth = 0.6,\n                strength = 0.2) +\n\n  # Destination airports (nodes)\n  geom_node_point(aes(filter = !is_atl),\n                  color = \"gold\",\n                  size = 1,\n                  alpha = 0.6) +\n                    \n  # ATL airport (origin)\n  geom_node_point(aes(filter = is_atl),\n                  color = \"white\",\n                  size = 2) +\n  # Styling\n  scale_edge_width(range = c(0.2, 1), guide = 'none') +\n  coord_map(\"mercator\", xlim = c(-125, -65), ylim = c(25, 50)) +\n  theme_void() +\n  theme(\n    plot.background = element_rect(fill = \"#040608ff\", color = NA),\n    plot.margin = margin(10, 10, 10, 10),\n    legend.position = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](10_air_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "10_air_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}